/*! quoteme.js - v0.2 - 2015-01-14 - Kostas Bariotis */
(function(){function t(t){"use strict";function e(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}var n="https://twitter.com/intent/tweet?",o=t.Quoteme=function(t){this.mouseUpXPosition=null,this.mouseDownXPosition=null,this.config={container:".article",pathToImg:"",viaParam:"kbariotis"},t=t||{};for(var e in t)t.hasOwnProperty(e)&&this.config.hasOwnProperty(e)&&(this.config[e]=t[e]);if(!document.querySelector(this.config.container))throw Error("No containers found on");return this.floatElement=this.createShareElement(),this.floatElement=this.styleShareElement(this.floatElement),this.bindUIEvents(),this};o.prototype.bindUIEvents=function(){e(document.querySelector(this.config.container),"mouseup",this.getSelection.bind(this)),e(document.querySelector(this.config.container),"mousedown",this._setMouseDownPosition),e(this.floatElement,"click",this.openPopup.bind(this))},o.prototype.getSelection=function(t){this._setMouseUpPosition(t);var e=document.getSelection();if(!(""+e)||"A"===t.target.tagName)return this.floatElement.style.display="none",!1;var o=""+e,i=parseInt(this.config.viaParam.length)+parseInt(document.location.href.length)+7;return parseInt(o.length)+i>140&&(o=o.substring(0,135-parseInt(i))),o='"'+o.replace(/(\r\n|\n|\r)/gm,"")+'..."',this.shareUrl=n,this.shareUrl+="text="+encodeURIComponent(o),this.shareUrl+="&via="+encodeURIComponent(this.config.viaParam),this.shareUrl+="&url="+document.location,this.displayShareButton(e),!0},o.prototype.createShareElement=function(){var t=document.createElement("a");return t.href="#",document.body.appendChild(t),t},o.prototype.getFloatElement=function(){return this.floatElement},o.prototype._setMouseDownPosition=function(t){return this.mouseDownXPosition=t.pageX,this},o.prototype._setMouseUpPosition=function(t){return this.mouseUpXPosition=t.pageX,this},o.prototype.styleShareElement=function(t){t.style.position="absolute",t.style.display="none",t.style.width="40px",t.style.height="40px",t.style.background="rgba(0,0,0,0.5)";var e=this.config.pathToImg?this.config.pathToImg:"https://raw.githubusercontent.com/kbariotis/quoteme.js/master/dist/tw.png";return t.style.backgroundImage="url("+e+")",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center",t.style.borderRadius="4%",t.style.pointer="cursor",t},o.prototype.displayShareButton=function(t){var e=parseInt(this.floatElement.style.height);this.floatElement.style.left=(this.mouseDownXPosition+this.mouseUpXPosition)/2-e/2+"px",this.floatElement.style.top=Math.min(t.anchorNode.parentElement.offsetTop,t.focusNode.parentElement.offsetTop)-e+"px",this.floatElement.style.display="block"},o.prototype.openPopup=function(){var t=575,e=400,n=(window.innerWidth-t)/2,o=(window.innerHeight-e)/2,i=this.shareUrl,s="status=1,width="+t+",height="+e+",top="+o+",left="+n;window.open(i,"twitter",s)}}var e=Function;new e("return this")();var n=function(e){return t(e),e.Quoteme};"function"==typeof define&&define.amd?define(function(){return n({})}):n(this)})(this);